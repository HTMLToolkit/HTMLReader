<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self' blob: data:;
    script-src 'self';
    style-src 'self' 'unsafe-inline';
    img-src 'self' blob: data:;
    connect-src 'self';
    frame-src 'self' blob: data:;
    worker-src 'self';
    manifest-src 'self';
    upgrade-insecure-requests; block-all-mixed-content;">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTMLReader</title>
  <script type="module" crossorigin src="./assets/index-Cf-RCOeo.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/index-D2o6aUx6.css">
<link rel="manifest" href="./manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="./registerSW.js"></script></head>
<body>
  <header>
    <div class="title">
      <span>HTMLReader</span>
      <span class="book-title" id="book-title"></span>
    </div>
    <div class="controls">
      <button id="toc-button" disabled>Table of Contents</button>
      <button id="open-button">Open EPUB</button>
      <button id="library-button">Library</button>
      <input type="file" id="file-input" class="file-input" accept=".epub">
      <!-- Fallback multiple file input for library import -->
      <input type="file" id="library-input" class="file-input" accept=".epub" multiple>
      <button id="install-button" hidden>Install App</button> <!-- New Install Button -->
    </div>
  </header>
  <main>
    <div id="viewer"></div>
  </main>
  <footer>
    <button id="prev-button" disabled>⬅ Previous</button>
    <div class="page-info">
      <span>Page</span>
      <input type="number" id="current-page" min="1" value="1">
      <span>of</span>
      <span id="total-pages">1</span>
    </div>
    <button id="next-button" disabled>Next ➡</button>
  </footer>
  <!-- TOC Container -->
  <div class="toc-container" id="toc-container">
    <div class="toc-header">
      <h3>Table of Contents</h3>
      <button id="close-toc">Close</button>
    </div>
    <div class="toc-content" id="toc-content"></div>
  </div>
  <!-- Library Popup (hidden by default) -->
  <div class="library-container" id="library-container">
    <div class="library-header">
      <h3>Library</h3>
      <button id="close-library">Close</button>
    </div>
    <div class="library-content" id="library-content"></div>
  </div>
  <div class="overlay" id="overlay"></div>
  <div class="message" id="loading-message">
    <h3>Loading EPUB...</h3>
    <p>Please wait while your book is being processed.</p>
  </div>
  <div class="message" id="error-message">
    <h3>Error</h3>
    <p id="error-text">There was an error processing your EPUB file.</p>
    <button id="close-error">Close</button>
  </div>
</body>
</html>